{{ define "main" }}

<div class="td-content">
  <h1>{{ .Title }}</h1>
  {{ with .Params.description }}<div class="lead">{{ . | markdownify }}</div>{{ end }}
  <header class="article-meta">
    {{ $context := . }}
    {{ if .Site.Params.Taxonomy.taxonomyPageHeader }}
      {{ range $index, $taxo := .Site.Params.Taxonomy.taxonomyPageHeader }}
        {{ partial "taxonomy_terms_article.html" (dict "context" $context "taxo" $taxo ) }}
      {{ end }}
    {{ else }}
      {{ range $taxo, $taxo_map := .Site.Taxonomies }}
        {{ partial "taxonomy_terms_article.html" (dict "context" $context "taxo" $taxo ) }}
      {{ end }}
    {{ end }}
    {{ if (and (not .Params.hide_readingtime) (.Site.Params.ui.readingtime.enable)) }}
      {{ partial "reading-time.html" . }}
    {{ end }}
  </header>    

  {{ $GedFile := (.FirstSection.Resources.GetMatch "potter_universe.ged").Permalink }}
	<div >
    <h4 class="h3">
      Biographical Information
    </h4>
    <div class="mb-0" id="bio-info" 
	  	x-data="{
				birthday: 'Unset',
			}"
			x-init="
				console.log('GedFile is {{ $GedFile }}');
  	    $store.HPGedCom.myURL = '{{ $GedFile }}';
				await $store.HPGedCom.initGC();
				if ($store.HPGedCom.isLoaded()) {
					birthday = $store.HPGedCom.bDay('@I0001@');
					console.log('HPGedCom isLoaded is ' + $store.HPGedCom.isLoaded());
				} else {
					console.log('not ready to call birthday');
				}

			"
		>
		Birthday: <span x-on:alpine:init="(e) => { console.log('in x-on'); birthday = $store.HPGedCom.bDay('@I0001@'); }" x-init="
				$watch($store.HPGedCom.myHPGC.isLoaded, value => { 
					console.log('value changed to ' + value); 
					birthday = $store.HPGedCom.bDay('@I0001@');
				});
			" x-text="birthday">didn't work</span><br/>
			Death: <span x-data="{ message: 'I ❤️  Alpine' }" x-text="message"></span>
    </div>
  </div>

  {{ .Content }}
  {{ if (and (not .Params.hide_feedback) (.Site.Params.ui.feedback.enable) (.Site.GoogleAnalytics)) }}
    {{ partial "feedback.html" .Site.Params.ui.feedback }}
    <br />
  {{ end }}
  {{ if (.Site.Params.DisqusShortname) }}
    <br />
    {{ partial "disqus-comment.html" . }}
  {{ end }}
  {{ partial "page-meta-lastmod.html" . }}
</div>

{{ end }}
